(this["webpackJsonpvisual-music-art"]=this["webpackJsonpvisual-music-art"]||[]).push([[0],{158:function(t,e,i){},165:function(t,e,i){"use strict";i.r(e);var n=i(0),a=i(4),o=i.n(a),r=i(65),s=i.n(r),c=i(7),l=i(8),h=i(11),u=i(10),d=(i(158),i(3)),v=i(5),j=i(27),f=i(13),p=i(16),b=function(t){Object(h.a)(i,t);var e=Object(u.a)(i);function i(t){var a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{top:0,right:0,bottom:0,left:0},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,l=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],h=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];Object(c.a)(this,i),(a=e.call(this,t)).onResize=function(){},a.increaseRows=function(){var t=a.state,e=t.rowSpan,i=t.rowlimit,n=t.margin,o=t.canResizeRows,r=a.props.viewSize.outerHeight;if(o&&!(e>=i)){var s=e+1,c=r*s;a.setState({rowSpan:s,viewHeight:c,height:c-n.top-n.bottom},a.onResize)}},a.decreaseRows=function(){var t=a.state,e=t.rowSpan,i=t.margin,n=t.canResizeRows,o=a.props.viewSize.outerHeight;if(n&&!(e<=1)){var r=e-1,s=o*r;a.setState({rowSpan:r,viewHeight:s,height:s-i.top-i.bottom},a.onResize)}},a.increaseColumns=function(){var t=a.state,e=t.columnSpan,i=t.columnLimit,n=t.margin,o=t.canResizeColumns,r=a.props.viewSize.outerWidth;if(o&&!(e>=i)){var s=e+1,c=r*s;a.setState({columnSpan:s,viewWidth:c,width:c-n.left-n.right},a.onResize)}},a.decreaseColumns=function(){var t=a.state,e=t.columnSpan,i=t.margin,n=t.canResizeColumns,o=a.props.viewSize.outerWidth;if(n&&!(e<=1)){var r=e-1,s=o*r;a.setState({columnSpan:r,viewWidth:s,width:s-i.left-i.right},a.onResize)}},a.close=function(){var t=a.props,e=t.toggleView,i=t.name;e&&i&&e(i)},a.getSizeControlHTML=function(){return Object(n.jsxs)("div",{className:"sizeControl",children:[a.state.canResizeRows&&Object(n.jsxs)("span",{children:[Object(n.jsx)("button",{onClick:a.increaseRows,title:"Increase rows",disabled:a.state.rowSpan>=a.state.rowlimit,children:Object(n.jsx)(f.a,{icon:p.b})}),Object(n.jsx)("button",{onClick:a.decreaseRows,title:"Decrease rows",disabled:a.state.rowSpan<=1,children:Object(n.jsx)(f.a,{icon:p.d})})]}),a.state.canResizeColumns&&Object(n.jsxs)("span",{children:[Object(n.jsx)("button",{onClick:a.increaseColumns,title:"Increase columns",disabled:a.state.columnSpan>=a.state.columnLimit,children:Object(n.jsx)(f.a,{icon:p.a})}),Object(n.jsx)("button",{onClick:a.decreaseColumns,title:"Decrease columns",disabled:a.state.columnSpan<=1,children:Object(n.jsx)(f.a,{icon:p.c})})]}),Object(n.jsx)("button",{onClick:a.close,title:"Close",children:Object(n.jsx)(f.a,{icon:p.e})})]})};var u=t.viewSize,d=u.outerWidth,v=u.outerHeight,j=d*s,b=v*r;return a.state={rowSpan:r,columnSpan:s,canResizeRows:l,canResizeColumns:h,rowlimit:12,columnLimit:2,outerWidth:d,outerHeight:v,viewHeight:b,viewWidth:j,margin:o,width:d*s-o.left-o.right,height:v*r-o.top-o.bottom},a}return Object(l.a)(i,[{key:"resizeComponent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.props.viewSize,i=e.outerWidth,n=e.outerHeight,a=this.state,o=a.outerWidth,r=a.outerHeight,s=a.margin,c=a.rowSpan,l=a.columnSpan;if(o!==i||r!==n){var h=i*l,u=n*c;this.setState(Object(j.a)(Object(j.a)({},t),{},{outerWidth:i,outerHeight:n,viewWidth:h,viewHeight:u,width:i*l-s.left-s.right,height:n*c-s.top-s.bottom}),this.onResize)}}}]),i}(a.PureComponent),m=i(12),w=function(t){Object(h.a)(i,t);var e=Object(u.a)(i);function i(){var t;Object(c.a)(this,i);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))).componentDidMount=function(){return t.initialize()},t.onResize=function(){t.initialize()},t.initialize=function(){m.Canvas.setupCanvas(t.canvas),t.setState({initialized:!0})},t.draw=function(){var e=t.state,i=e.viewWidth,n=e.viewHeight,a=t.props.notes;console.log(a);var o=Object(v.b)(a,(function(t){return t.end})),r=Object(v.a)(a,(function(t){return t.pitch})),s=.3*Math.max(i,n),c=Math.min(s/o/2,5),l=Object(v.c)().domain([0,o]).range([12*c,s]),h=Object(v.c)().domain(r).range([c,c*(r[1]-r[0])]),u=t.canvas.getContext("2d");u.clearRect(0,0,i,n),u.fillStyle="rgba(255, 255, 255, 0.3)";for(var j=i/2,f=n/2,p=0;p<a.length;p++){var b,w=a[p],g=j+l(w.start),O=f+h(w.pitch),z=t.getRotatedPositions(g,O,j,f),S=Object(d.a)(z);try{for(S.s();!(b=S.n()).done;){var x=b.value;m.Canvas.drawFilledCircle(u,x.x,x.y,c)}}catch(y){S.e(y)}finally{S.f()}}},t}return Object(l.a)(i,[{key:"componentDidUpdate",value:function(){this.resizeComponent(),this.draw()}},{key:"getRotatedPositions",value:function(t,e,i,n){var a=[],o=0;if(e!==n){var r=t-i,s=e-n;o=Math.atan(s/r)}for(var c=Math.hypot(t-i,e-n),l=0;l<6;l++){var h=60*l/180*Math.PI+o,u=i+Math.cos(h)*c,d=n+Math.sin(h)*c;if(a.push({x:u,y:d}),0!==o){var v=n-Math.sin(h)*c;a.push({x:u,y:v})}}return a}},{key:"render",value:function(){var t=this,e=this.state,i=e.viewWidth,a=e.viewHeight;return this.canvas&&this.draw(),Object(n.jsx)("div",{className:"NoteFlake",children:Object(n.jsx)("canvas",{className:"ViewCanvas",ref:function(e){return t.canvas=e},style:{width:i,height:a}})})}}]),i}(b),g=function(t){Object(h.a)(i,t);var e=Object(u.a)(i);function i(){var t;Object(c.a)(this,i);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))).componentDidMount=function(){return t.initialize()},t.onResize=function(){t.initialize()},t.initialize=function(){m.Canvas.setupCanvas(t.canvas),t.setState({initialized:!0})},t.draw=function(){var e=t.state,i=e.viewWidth,n=e.viewHeight,a=t.props.tracks,o=Object(v.b)(a,(function(t){return Object(v.b)(t,(function(t){return t.end}))})),r=Object(v.a)(a.flatMap((function(t){return t.map((function(t){return t.pitch}))}))),s=.35*Math.max(i,n),c=Math.min(s/o/2,5),l=Object(v.c)().domain([0,o]).range([s/10,s]),h=c*(r[1]-r[0])/2,u=Object(v.c)().domain(r).range([-h,h]),j=t.canvas.getContext("2d");j.clearRect(0,0,i,n);for(var f=i/2,p=n/2,b=0;b<a.length;b++){j.fillStyle=v.d[b%10];var w,g=Object(d.a)(a[b]);try{for(g.s();!(w=g.n()).done;){var O=w.value,z=f+l(O.start),S=p-u(O.pitch),x=t.getRotatedPosition(z,S,f,p,b,a.length);m.Canvas.drawFilledCircle(j,x.x,x.y,c)}}catch(y){g.e(y)}finally{g.f()}}},t}return Object(l.a)(i,[{key:"componentDidUpdate",value:function(){this.resizeComponent(),this.draw()}},{key:"getRotatedPosition",value:function(t,e,i,n,a,o){var r=0;if(e!==n){var s=t-i,c=e-n;r=Math.atan(c/s)}var l=Math.hypot(t-i,e-n),h=360/o*a/180*Math.PI+r;return{x:i+Math.cos(h)*l,y:n+Math.sin(h)*l}}},{key:"render",value:function(){var t=this,e=this.state,i=e.viewWidth,a=e.viewHeight;return this.canvas&&this.draw(),Object(n.jsx)("div",{className:"NoteFlake",children:Object(n.jsx)("canvas",{className:"ViewCanvas",ref:function(e){return t.canvas=e},style:{width:i,height:a}})})}}]),i}(b),O=i(68),z=i(67),S=i.n(z),x=function(t){Object(h.a)(i,t);var e=Object(u.a)(i);function i(t){var n;return Object(c.a)(this,i),(n=e.call(this,t)).onResize=function(){n.setState({viewSize:{outerWidth:Math.floor(window.innerWidth-20),outerHeight:Math.floor(window.innerHeight-200)}})},n.state={viewSize:{outerWidth:800,outerHeight:600},midiFileData:[],notes:[]},n}return Object(l.a)(i,[{key:"componentDidMount",value:function(){var t=this;window.addEventListener("resize",this.onResize,!1),this.onResize();var e=document.getElementById("filereader");S.a.parse(e,(function(e){try{var i=Object(m.preprocessMidiFileData)(e).parts.map((function(t){return t.noteObjs}));t.setState({midiFileData:i,notes:i[0]})}catch(n){alert("Invalid MIDI file or wrong format!")}}))}},{key:"render",value:function(){var t=this.state;return Object(n.jsxs)("div",{className:"App dark",children:[Object(n.jsx)("div",{children:Object(n.jsxs)("label",{children:["Open a MIDI file",Object(n.jsx)("input",{className:"fileInput",type:"file",id:"filereader",accept:".midi,.mid"})]})}),Object(n.jsx)(g,{viewSize:t.viewSize,tracks:t.midiFileData}),Object(n.jsx)(w,{viewSize:t.viewSize,notes:t.notes}),Object(n.jsx)("div",{className:"githubLink",children:Object(n.jsxs)("a",{href:"https://github.com/fheyen/visual-music-art",target:"blank",children:[Object(n.jsx)(f.a,{icon:O.a}),"\xa0 https://github.com/fheyen/visual-music-art"]})})]})}}]),i}(a.Component);s.a.render(Object(n.jsx)(o.a.StrictMode,{children:Object(n.jsx)(x,{})}),document.getElementById("root"))}},[[165,1,2]]]);
//# sourceMappingURL=main.a6fa4310.chunk.js.map